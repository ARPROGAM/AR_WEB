<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YouTube Shorts Looper</title>
    <meta name="description" content="Avtomatik ravishda YouTube Shorts videolarini aralash tartibda ijro etuvchi looper.">

    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            width: 100vw;
            touch-action: manipulation; /* Barmoqni siljitishni nazorat qilish */
            -webkit-tap-highlight-color: transparent; /* Chrome'dagi tugma bosish effektini o'chirish */
            cursor: pointer; /* Boshqa tugma yo'qligi uchun kursor shakli */
        }

        #player-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #000;
        }

        #player {
            width: 100vw;
            height: calc(100vw * 16 / 9); /* 9:16 nisbatda balandlikni hisoblaymiz */
            max-height: 100vh;
            max-width: calc(100vh * 9 / 16);
            
            display: block;
            margin: auto;
            transform: translateY(0);
        }

        @media (orientation: portrait) {
            #player {
                height: 100vh;
                width: calc(100vh * 9 / 16);
            }
        }
        @media (orientation: landscape) {
            #player {
                width: 100vw;
                height: calc(100vw * 16 / 9);
            }
        }

        #status-message {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 0.9em;
            z-index: 10;
            white-space: nowrap;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }
        #status-message.hidden {
            opacity: 0;
        }

        #unmute-button {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 1.1em;
            cursor: pointer;
            z-index: 10;
            display: none; /* Dastlab yashirilgan */
            opacity: 0;
            transition: opacity 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        #unmute-button.visible {
            opacity: 1;
            display: block;
        }
        #unmute-button:hover {
            background-color: rgba(0, 0, 0, 0.9);
        }
        
        #initial-tap-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            color: white;
            font-size: 1.5em;
            text-align: center;
            z-index: 100; /* Barcha elementlarning ustida bo'lishi uchun */
            cursor: pointer;
            transition: opacity 0.5s ease;
            opacity: 1;
        }
        #initial-tap-overlay.hidden {
            opacity: 0;
            pointer-events: none; /* Yashirilganda hodisalarni o'tkazib yuborsin */
        }
        #initial-tap-overlay p {
            margin-bottom: 20px;
        }
        #initial-tap-overlay span {
            font-size: 0.8em;
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <div id="player-container">
        <div id="player"></div>
        <div id="status-message">Yuklanmoqda...</div>
        <button id="unmute-button">Ovozni o'chirish</button>
    </div>

    <!-- Birinchi teginish uchun overlay -->
    <div id="initial-tap-overlay">
        <p>Davom etish va ovozni yoqish uchun ekranga teging.</p>
        <span>(Videolar ovozsiz boshlanadi va keyingi videoga o'tishda avtomatik o'chadi)</span>
    </div>

    <script>
        // --- KONFIGURATSIYA ---
        const youtubeShortsIds = [
            "0GncAgJHlTU", "mmILvCb1Xgc", "efoBs9GJqv0", "XqxXiSHgsQQ", "yA2wek6wr-c",
            "YKvmlno3aMc", "Hhxd0rQDOvs", "CwrwOF0aj4g", "deipMsp2u6I", "1zdaHrVlfjE",
            "K46BWn2sMU0", "iMjf9OfNBRI", "wI9-wohtGuY", "Wmh92X5TPIQ", "LFhEoSXo5Yc"
        ];
        const transitionDelaySeconds = 8; // Keyingi videoga o'tish vaqti (sekundlarda)
        // --- KONFIGURATSIYA TUGADI ---

        let player;
        let shuffledShorts = [];
        let currentVideoIndex = 0;
        let transitionTimer;
        let isMuted = true;
        let hasInteracted = false; // Foydalanuvchi bilan o'zaro aloqa bo'lganligini bildiradi

        const statusMessage = document.getElementById('status-message');
        const unmuteButton = document.getElementById('unmute-button');
        const initialTapOverlay = document.getElementById('initial-tap-overlay');

        // YouTube IFrame Player API yuklash
        function loadYouTubeAPI() {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        }

        // Fisher-Yates shuffle algoritmi
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // YouTube Player tayyor bo'lganda chaqiriladi
        function onYouTubeIframeAPIReady() {
            shuffledShorts = shuffleArray([...youtubeShortsIds]);
            showStatus('Player yuklanmoqda...');

            player = new YT.Player('player', {
                height: '100%',
                width: '100%',
                videoId: shuffledShorts[currentVideoIndex],
                playerVars: {
                    'controls': 0,
                    'autoplay': 1,
                    'mute': 1, // Dastlab ovozsiz boshlash
                    'loop': 1,
                    'playlist': shuffledShorts[currentVideoIndex],
                    'disablekb': 1,
                    'fs': 0,
                    'rel': 0,
                    'modestbranding': 1,
                    'playsinline': 1
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange,
                    'onError': onPlayerError
                }
            });
        }

        // Player tayyor bo'lganda
        function onPlayerReady(event) {
            event.target.mute(); // Qo'shimcha ovozsiz qilish
            isMuted = true;
            showStatus('Yuklandi. O\'ynatish boshlanmoqda...', true);
            event.target.playVideo();
        }

        // Player holati o'zgarganda
        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                clearTimeout(transitionTimer);
                transitionTimer = setTimeout(playNextVideo, transitionDelaySeconds * 1000);
                showStatus(`O'ynatilmoqda: ${currentVideoIndex + 1}/${shuffledShorts.length}`, true);
                // Agar ovoz yoqilgan bo'lsa, mute/unmute tugmasini ko'rsatamiz
                if (!isMuted && hasInteracted) {
                    unmuteButton.classList.add('visible');
                    unmuteButton.textContent = 'Ovozni o\'chirish';
                } else if (isMuted && hasInteracted) {
                    unmuteButton.classList.add('visible'); // Ovoz yoqilmagan bo'lsa ham ko'rsatamiz
                    unmuteButton.textContent = 'Ovozni yoqish';
                }
            } else if (event.data === YT.PlayerState.BUFFERING) {
                showStatus('Buferlanmoqda...');
                unmuteButton.classList.remove('visible'); // Buferlanayotganda yashiramiz
            } else if (event.data === YT.PlayerState.PAUSED) {
                showStatus('To\'xtatilgan.');
                unmuteButton.classList.add('visible'); // To'xtatilganda ko'rsatamiz
            }
        }

        // Player xatolik berganida
        function onPlayerError(event) {
            console.error('YouTube Player Error:', event.data);
            showStatus(`Xatolik: ${event.data}. Keyingisiga o'tilmoqda...`, true);
            clearTimeout(transitionTimer);
            transitionTimer = setTimeout(playNextVideo, 3000);
        }

        // Keyingi videoni ijro etish
        function playNextVideo() {
            currentVideoIndex++;
            if (currentVideoIndex >= shuffledShorts.length) {
                currentVideoIndex = 0;
                shuffledShorts = shuffleArray([...youtubeShortsIds]);
            }
            const nextVideoId = shuffledShorts[currentVideoIndex];
            player.loadVideoById(nextVideoId, 0);
            player.mute(); // Har doim ovozsiz boshlash
            isMuted = true;
            unmuteButton.classList.remove('visible'); // Keyingi videoga o'tishda tugmani yashiramiz
            showStatus(`Keyingi video yuklanmoqda: ${currentVideoIndex + 1}/${shuffledShorts.length}`);
        }

        // Status xabarini ko'rsatish funksiyasi
        let statusHideTimer;
        function showStatus(message, autoHide = false) {
            statusMessage.textContent = message;
            statusMessage.classList.remove('hidden');
            clearTimeout(statusHideTimer);
            if (autoHide) {
                statusHideTimer = setTimeout(() => {
                    statusMessage.classList.add('hidden');
                }, 3000);
            }
        }

        // Ovozni yoqish / o'chirish tugmasining funksiyasi
        unmuteButton.addEventListener('click', (event) => {
            event.stopPropagation(); // Ekranga teginish hodisasini to'xtatish
            if (player) {
                if (isMuted) {
                    player.unMute();
                    unmuteButton.textContent = 'Ovozni o\'chirish';
                    showStatus('Ovoz yoqildi.', true);
                } else {
                    player.mute();
                    unmuteButton.textContent = 'Ovozni yoqish';
                    showStatus('Ovoz o\'chirildi.', true);
                }
                isMuted = !isMuted;
            }
        });

        // Ekranga birinchi teginish hodisasi
        document.body.addEventListener('touchstart', handleInitialInteraction, { once: true });
        document.body.addEventListener('mousedown', handleInitialInteraction, { once: true });

        function handleInitialInteraction() {
            if (!hasInteracted) {
                hasInteracted = true;
                initialTapOverlay.classList.add('hidden'); // Overlayni yashirish
                // Ovozni yoqish
                if (player && isMuted) {
                    player.unMute();
                    isMuted = false;
                    unmuteButton.textContent = 'Ovozni o\'chirish';
                    unmuteButton.classList.add('visible'); // Tugmani ko'rsatish
                    showStatus('Ovoz yoqildi.', true);
                }
                // Agar player hali tayyor bo'lmasa, onPlayerReady ichida ovoz yoqiladi
                // Bu yerda faqat user interaktsiyasi flagini sozlaymiz
            }
        }

        // Sahifa yuklanganda YouTube API'ni yuklash
        window.addEventListener('load', loadYouTubeAPI);
    </script>
</body>
</html>
